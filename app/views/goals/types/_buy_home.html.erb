<h2>Buy Home</h2>

<%= form_for @goal do |f| %>
  <%= render 'shared/error_messages', :object => f.object %>

  <%= hidden_field_tag "goal[category]", "Buy Home" %>
  <%= hidden_field_tag "type", "buy_home" %>
  <div class="field">
    <%= f.label :title, "Give it a title" %><br />
    <%= f.text_field :title %>
  </div>
  <div class="field">
    <%= f.label :amount %><br />
    <%= f.text_field :amount %>
  </div>
  <div class="field">
    <% for account in Account.find(:all) do %>
      <% if check_account_dedicated(account) %>
        <div class="available_accounts disabled">
          <%= check_box_tag "goal[account_ids][]", account.id, @goal.accounts.include?(account),
              { :id => "goal_account_ids_#{account.id}",
                :disabled => check_account_dedicated(account) } %>
          <%= account.name %> <small>(<em><%= account.amount %></em>already dedicated)</small>
        </div>
      <% else %>
        <div class="available_accounts">
          <%= check_box_tag "goal[account_ids][]", account.id, @goal.accounts.include?(account),
              { :id => "goal_account_ids_#{account.id}" } %>
          <%= account.name %> <small>(available: <em><%= account.amount %></em>)</small>
        </div>
      <% end %>
    <% end %>
  </div>
  <div class="field">
    Your balance is: <span id="goal_current_balance"></span>
    </div>
  <div class="field">
    <%= f.label :planned_date %><br />
    <%= f.date_select :planned_date, :discard_day => true, :start_year => Date.today.year.next %>
  </div>
  <div class="field">
    <%= f.label :contribution, "Your monthly contribution" %><br />
    <%= f.text_field :contribution %>
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %>
